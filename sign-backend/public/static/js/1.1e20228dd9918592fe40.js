webpackJsonp([1],{"F+jZ":function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return i});var r={DAY:1,WEEK:2,MONTH:3,YEAR:4,USERDEFINED:5},i={1:1,2:7,3:31,4:365,5:15}},"Q+Cr":function(e,t){},bSzG:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("Xxa5"),i=n.n(r),a=n("exGp"),s=n.n(a),c=n("F+jZ"),o=n("1h8J"),u={data:function(){return{prizes:[],signon:{},isEdit:!0,prize:{},prizeList:[],total:0,sceneId:0,type:1,cycleNum:0,pageInfo:{page:1,pageSize:10}}},components:{"prize-list-dialog":function(){return n.e(14).then(n.bind(null,"PcCh"))}},created:function(){this.sceneId=this.$route.query.id,this.initData(this.sceneId)},methods:{initData:function(e){var t=this;return s()(i.a.mark(function n(){var r,a,s;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(o.n)({id:e});case 2:if(r=n.sent,a=[],200===r.status){for(t.signon=r.data,t.cycleNum=t.signon.cycle_text.number?t.signon.cycle_text.number:c.b[t.signon.cycle_text.type],s=1;s<=t.cycleNum;s++)t.signon.prizes_text&&t.signon.prizes_text.prizes&&t.signon.prizes_text.prizes[0]&&t.signon.prizes_text.prizes[0][s]?a.push({index:s,prizeIds:t.signon.prizes_text.prizes[0][s]}):a.push({index:s,prizeIds:[]});t.prizes=a}console.log("signon: ",t.signon);case 6:case"end":return n.stop()}},n,t)}))()},handleSizeChange:function(e){var t=this;return s()(i.a.mark(function n(){return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.pageInfo.pageSize=e,n.next=3,t.getPrizesBySignon();case 3:case"end":return n.stop()}},n,t)}))()},handleCurrentChange:function(e){var t=this;return s()(i.a.mark(function n(){return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.pageInfo.page=e,n.next=3,t.getPrizesBySignon();case 3:case"end":return n.stop()}},n,t)}))()},handleSignOnPrize:function(e){var t=this;return s()(i.a.mark(function n(){var r,a;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=[],e instanceof Array?e.forEach(function(e){r.push(e.id)}):r.push(e.id),a={},1!==t.type){n.next=9;break}return n.next=6,Object(o.q)({id:t.signon.id,prizeIds:r,number:t.prize.index,type:t.type});case 6:a=n.sent,n.next=12;break;case 9:return n.next=11,Object(o.r)({id:t.signon.id,prizeIds:r,number:t.prize.index,type:t.type});case 11:a=n.sent;case 12:200===a.status?(t.$message({message:"操作成功",type:"success"}),t.$refs.prizeListRef.close(),t.initData(t.sceneId)):t.$message.error("操作失败");case 13:case"end":return n.stop()}},n,t)}))()},getPrizesBySignon:function(){var e=this;return s()(i.a.mark(function t(){var n;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(o.l)({id:e.signon.id,number:e.prize.index,type:e.type,page:e.pageInfo.page,pageSize:e.pageInfo.pageSize});case 2:if(200!==(n=t.sent).status){t.next=8;break}if(n.data.list&&!(n.data.list.length<1)){t.next=6;break}return t.abrupt("return",!1);case 6:e.prizeList=n.data.list,e.total=n.data.total;case 8:return t.abrupt("return",n);case 9:case"end":return t.stop()}},t,e)}))()},openPrizeList:function(e,t,n){var r=this;return s()(i.a.mark(function e(){var a,c,o;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r.type=n,r.prize=t,r.pageInfo={page:1,pageSize:10},e.next=5,r.getPrizesBySignon();case 5:if(e.sent){e.next=9;break}return 1===r.type?r.$message.error("暂无新奖品"):r.$message.error("未配置奖品"),e.abrupt("return");case 9:a=r,c={btn_text:"添加",m_btn_text:"批量添加",type:"primary"},2===r.type&&(c={btn_text:"删除",m_btn_text:"批量删除",type:"danger"}),o={actionbutton:[{label:c.btn_text,type:c.type,size:"mini",action:function(){var e=s()(i.a.mark(function e(t){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a.handleSignOnPrize(t);case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}],bluckActionbutton:[{label:c.m_btn_text,type:c.type,size:"mini",action:function(){var e=s()(i.a.mark(function e(t){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a.handleSignOnPrize(t);case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}]},r.$refs.prizeListRef.open(o);case 14:case"end":return e.stop()}},e,r)}))()}}},p={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"fillcontain"},[n("div",{staticClass:"table_container"},[e._m(0),e._v(" "),n("div",{staticClass:"mar10 pad10"},[e._v("名称: "+e._s(e.signon.name))]),e._v(" "),e.signon.checkin_type?n("div",{staticClass:"mar10 pad10"},[e._v("类型: "+e._s(e.signon.checkin_type.name))]):e._e(),e._v(" "),e.signon.cycle_text?n("div",{staticClass:"mar10 pad10"},[e._v("签到周期: "+e._s(e.cycleNum)+" 天")]):e._e(),e._v(" "),n("div",{staticClass:"mar10"},[n("div",[n("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:e.prizes,stripe:""}},[n("el-table-column",{attrs:{prop:"index",label:"日期",width:"180"}}),e._v(" "),n("el-table-column",{attrs:{label:"奖品id"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.prizeIds))])]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"详情"},scopedSlots:e._u([{key:"default",fn:function(e){return[n("span")]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(n){return e.openPrizeList(t.$index,t.row,1)}}},[e._v("添加")]),e._v(" "),n("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(n){return e.openPrizeList(t.$index,t.row,2)}}},[e._v("删除")])]}}])})],1)],1)]),e._v(" "),n("div",[n("prize-list-dialog",{ref:"prizeListRef",attrs:{sizeChange:e.handleSizeChange,currentChange:e.handleCurrentChange,isEdit:e.isEdit,total:e.total,prizeList:e.prizeList}})],1)])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"mar10"},[t("h3",[this._v("奖品管理")])])}]};var l=n("VU/8")(u,p,!1,function(e){n("Q+Cr")},null,null);t.default=l.exports}});
//# sourceMappingURL=1.1e20228dd9918592fe40.js.map